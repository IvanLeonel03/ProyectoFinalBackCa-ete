<div class="container">
    {{#if product}}
        <div class="product-detail">
            <!-- Navegaci√≥n -->
            <nav class="breadcrumb">
                <a href="/products">Productos</a>
                <span> > </span>
                <span>{{product.title}}</span>
            </nav>
            
            <div class="product-detail-content">
                <!-- Galer√≠a de im√°genes -->
                <div class="product-gallery">
                    {{#if product.thumbnails.length}}
                        <div class="main-image">
                            <img src="{{product.thumbnails.[0]}}" alt="{{product.title}}" id="mainImage"
                                 onerror="this.src='https://via.placeholder.com/500x400/95a5a6/ffffff?text=Imagen+No+Disponible'">
                        </div>
                    {{else}}
                        <div class="no-image-large">
                            üñºÔ∏è Imagen no disponible
                        </div>
                    {{/if}}
                </div>
                
                <!-- Informaci√≥n del producto -->
                <div class="product-info-detail">
                    <h1 class="product-title-detail">{{product.title}}</h1>
                    <p class="product-category-detail">Categor√≠a: <strong>{{product.category}}</strong></p>
                    
                    <div class="product-price-detail">
                        {{formatPrice product.price}}
                    </div>
                    
                    <div class="product-stock-detail {{#eq product.stock 0}}out-of-stock{{/eq}} 
                                                  {{#and (gt product.stock 0) (lt product.stock 5)}}low-stock{{/and}}">
                        {{#eq product.stock 0}}
                            ‚ùå Producto agotado
                        {{else}}
                            ‚úÖ En stock: <strong>{{product.stock}} unidades</strong>
                            {{#lt product.stock 5}}
                                <span class="stock-warning">(¬°√öltimas unidades!)</span>
                            {{/lt}}
                        {{/eq}}
                    </div>
                    
                    <div class="product-description-detail">
                        <h3>Descripci√≥n:</h3>
                        <p>{{product.description}}</p>
                    </div>
                    
                    <div class="product-code">
                        <strong>C√≥digo:</strong> <code>{{product.code}}</code>
                    </div>
                    
                    <!-- Acciones -->
                    <div class="product-actions-detail">
                        <div class="quantity-selector">
                            <label for="quantity">Cantidad:</label>
                            <input type="number" id="quantity" name="quantity" value="1" min="1" max="{{product.stock}}">
                        </div>
                        
                        <button onclick="addToCartDetail('{{product._id}}')" 
                                class="btn btn-success btn-large"
                                {{#eq product.stock 0}}disabled{{/eq}}>
                            üõí Agregar al carrito
                        </button>
                        
                        <a href="/products" class="btn btn-outline btn-large">
                            ‚Ü©Ô∏è Volver a productos
                        </a>
                    </div>
                    
                    <!-- Informaci√≥n adicional -->
                    <div class="product-meta">
                        <div class="meta-item">
                            <strong>üì¶ Estado:</strong> 
                            {{#if product.status}}Activo{{else}}Inactivo{{/if}}
                        </div>
                        <div class="meta-item">
                            <strong>üÜî ID:</strong> {{product._id}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {{else}}
        <div class="error-product">
            <h2>‚ùå Producto no encontrado</h2>
            <p>El producto que buscas no existe o ha sido removido.</p>
            <a href="/products" class="btn btn-primary">Volver a la tienda</a>
        </div>
    {{/if}}

<script src="/js/cart.js"></script>

<script>
// Script adicional para la p√°gina de detalle
document.addEventListener('DOMContentLoaded', function() {
    console.log('‚úÖ P√°gina de detalle cargada');
    
    // Verificar que las funciones est√©n disponibles
    if (typeof addToCartDetail === 'function') {
        console.log('‚úÖ Funci√≥n addToCartDetail disponible');
    } else {
        console.error('‚ùå Funci√≥n addToCartDetail NO disponible');
    }
});
</script>
</div>